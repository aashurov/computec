{{ header }}
{{ column_left }}


<div id="content">
    <div class="page-header">
        <div class="container-fluid">
            <div class="pull-right">
                <button type="submit" form="form_push" data-toggle="tooltip" title="{{ button_save }}"
                        class="btn btn-primary"><i class="fa fa-save"></i></button>
                <a href="{{ cancel }}" data-toggle="tooltip" title="{{ button_cancel }}" class="btn btn-default"><i
                            class="fa fa-reply"></i></a></div>
            <h1>{{ heading_title }} V:{{ text_version }}</h1>
            <ul class="breadcrumb">
                <?php foreach ($breadcrumbs as $breadcrumb) { ?>
                <li><a href="{{ breadcrumb['href'] }}">{{ breadcrumb.text }}</a></li>
                <?php } ?>
            </ul>
        </div>
    </div>


    <form action="{{ action }}" method="post" id="form-push" class="form-horizontal">


        <div class="container-fluid">




            <div class="panel panel-default">





                <div class="panel-heading">
                    <h3 class="panel-title"><i class="fa fa-pencil"></i> {{ text_edit }} </h3>
                </div>
                <div class="panel-body">

                    <div id="status"></div>

                    {% if error_no_key %}
                        <div class="alert alert-danger" role="alert">{{ error_no_key }}</div>
                    {% endif %}


                    {% if error_no_chat_ids %}
                        <div class="alert alert-danger" role="alert">{{ error_no_chat_ids }}</div>
                    {% endif %}


                    <ul class="nav nav-tabs">
                        <li class="active"><a data-toggle="tab" href="#homeTable">{{ text_help_home_tabe }}</a></li>
                        <li><a data-toggle="tab" href="#helpTabe">{{ text_help_help_tabe }}</a></li>

                    </ul>


                    <div class="tab-content">
                        <div id="homeTable" class="tab-pane fade in active">

                            <div class="container col-12">




                                <div class="row">

                                    <div class="panel panel-default">
                                        <div class="panel-heading">
                                            <div class="row">
                                                <div class="col-md-1">
                                                    <button type="button" form="form-push" onclick="appChatID();"
                                                            data-toggle="tooltip" title="" class="btn btn-primary"
                                                            data-original-title="Add Chat IDs"><i class="fa fa-plus"></i>
                                                    </button>

                                                </div>
                                                <div class="col-md-1">
                                                    <button type="button" id="test" data-toggle="tooltip" title=""
                                                            class="btn btn-primary"
                                                            data-original-title="Test Push Notification"><i
                                                                class="fa fa-comments-o "></i></button>

                                                </div>




                                            </div>

                                        </div>
                                        <div class="panel-body">
                                            <div class="row " id="groubChatID">
                                                <div class="input-group col-md-6 input-boot-token">
                                                    <span class="input-group-addon">{{ entry_BOTTOKEN }}</span>
                                                    <input type="text" name="module_notificationTelegram_boot_token"
                                                           id="module_notificationTelegram_boot_token"
                                                           value="{{ module_notificationTelegram_boot_token }}"
                                                           placeholder="BOT_TOKEN"
                                                           class="form-control"/>
                                                    <span class="input-group-btn"><button class="btn btn-info " type="button"><i
                                                                    class="fa fa-bookmark"></i></button> </span>
                                                </div>


                                                {% for key,val in module_notificationTelegram_chat_ids %}

                                                    <div class="input-group col-md-6 " style=" padding-top: 3px;"
                                                         aria-hidden="true">
                                            <span class="input-group-addon"
                                                  id="basic-addon1">{{ entry_chatID }}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                                        <input type="text" name="module_notificationTelegram_chat_ids[]"
                                                               class="form-control"
                                                               value="{{ val }}"/>
                                                        <span class="input-group-btn"><button class="btn btn-danger removed"
                                                                                              type="button"><i
                                                                        class="fa fa-trash-o"></i></button></span>
                                                    </div>

                                                {% endfor %}


                                            </div>

                                        </div>
                                    </div>

                                    {#   Panel Alert#}

                                    <div class="panel panel-default">
                                        <div class="panel-heading"><label class="control-label"
                                                                          for="order_alert"> {{ text_help_new_order }}</label>
                                            <input type="checkbox" name="module_notificationTelegram_new_order_alert"
                                                   id="order_alert" {% if module_notificationTelegram_new_order_alert %} checked {% endif %}/>
                                        </div>
                                        <div class="panel-body">

                                            <div class="col-md-5 ">


                                       <textarea rows="15" cols="50" class="form-control"
                                                 id="module_notificationTelegram_new_order_meassage"
                                                 name="module_notificationTelegram_new_order_meassage"
                                                 rows="3">{% if module_notificationTelegram_new_order_meassage is empty %} {{ entry_new_order }} {% endif %}{% if module_notificationTelegram_new_order_meassage %}{{ module_notificationTelegram_new_order_meassage }}{% endif %}</textarea>

                                            </div>

                                            {#C#}
                                            <div class="col-md-6 ">

                                                <div class="btn-group btn-group-sm" data-toggle="buttons" id="newOrderList">

                                                </div>

                                            </div>
                                        </div>
                                    </div>


                                    <div class="panel panel-default">
                                        <div class="panel-heading"><label class=" control-label"
                                                                          for="module_notificationTelegram_new_customer_alert">{{ text_help_new_customer }}
                                            </label>
                                            <input type="checkbox" name="module_notificationTelegram_new_customer_alert"  id="module_notificationTelegram_new_customer_alert" {% if module_notificationTelegram_new_customer_alert %} checked {% endif %}/>


                                        </div>
                                        <div class="panel-body">
                                            <div class="col-md-5 B">

                                    <textarea rows="5" cols="50" class="form-control"
                                              id="module_notificationTelegram_new_custemer_meassage"
                                              name="module_notificationTelegram_new_custemer_meassage">{% if module_notificationTelegram_new_custemer_meassage is empty %} {{ entry_new_customer }} {% endif %}{% if module_notificationTelegram_new_custemer_meassage %}{{ module_notificationTelegram_new_custemer_meassage }}{% endif %}</textarea>

                                            </div>

                                            {#C#}
                                            <div class="col-md-6 C">

                                                <nav aria-label="...">
                                                    <ul class="pager" id="buttonKeyNewCustemer">
                                                    </ul>
                                                </nav>
                                            </div>
                                        </div>
                                    </div>


                                    <div class="panel panel-default">
                                        <div class="panel-heading"><label class=" control-label"
                                                                          for="customer_alert">{{ text_help_products }} </label>
                                            <input type="checkbox" name="module_notificationTelegram_product_alert"
                                                   id="module_notificationTelegram_product_alert" {% if
                                                module_notificationTelegram_product_alert %} checked {% endif %}
                                            />
                                        </div>

                                        <div class="panel-body">
                                            <div class="col-md-5 B">
                                     <textarea rows="5" cols="50" class="form-control"
                                               id="module_notificationTelegram_product_meassage"
                                               name="module_notificationTelegram_product_meassage">{% if module_notificationTelegram_product_meassage is empty %} {{ entry_products }} {% endif %}{% if module_notificationTelegram_product_meassage %}{{ module_notificationTelegram_product_meassage }}{% endif %}</textarea>

                                            </div>

                                            {#C#}
                                            <div class="col-md-6 C">

                                                <div class="pager" id="buttonKeyProduct">
                                                </div>


                                            </div>
                                        </div>
                                    </div>


                                    <div class="panel panel-default">
                                        <div class="panel-heading"><label class=" control-label"
                                                                          for="return"> {{ text_help_return_order }}</label>
                                            <input type="checkbox" name="module_notificationTelegram_return_order_alert"
                                                   id="return" {% if module_notificationTelegram_return_order_alert %} checked {% endif %}
                                            /></div>
                                        <div class="panel-body">

                                              <textarea rows="5" cols="50" class="form-control"
                                                        id="module_notificationTelegram_return_order_message"
                                                        name="module_notificationTelegram_return_order_message">{% if module_notificationTelegram_return_order_message is empty %} {{ entry_return_order }} {% endif %} {% if module_notificationTelegram_return_order_message %}{{ module_notificationTelegram_return_order_message }}{% endif %}</textarea>




                                        </div>
                                    </div>


                                </div>
                            </div>



                        </div>
                        <div id="helpTabe" class="tab-pane fade">


                            <div class="row">
                                <div class="col-md-8">


                                    <div class="alert" role="alert"><a href="https://core.telegram.org/bots/api#formatting-options" target="_blank">{{ text_help_telegram_html }}</a>

                                        <pre><code>&lt;b&gt;bold&lt;/b&gt;, &lt;strong&gt;bold&lt;/strong&gt;
                        &lt;i&gt;italic&lt;/i&gt;, &lt;em&gt;italic&lt;/em&gt;
                        &lt;u&gt;underline&lt;/u&gt;, &lt;ins&gt;underline&lt;/ins&gt;
                        &lt;s&gt;strikethrough&lt;/s&gt;, &lt;strike&gt;strikethrough&lt;/strike&gt;, &lt;del&gt;strikethrough&lt;/del&gt;
                        &lt;b&gt;bold &lt;i&gt;italic bold &lt;s&gt;italic bold strikethrough&lt;/s&gt; &lt;u&gt;underline italic bold&lt;/u&gt;&lt;/i&gt; bold&lt;/b&gt;
                        &lt;a href="http://www.example.com/"&gt;inline URL&lt;/a&gt;
                        &lt;a href="tg://user?id=123456789"&gt;inline mention of a user&lt;/a&gt;
                        &lt;code&gt;inline fixed-width code&lt;/code&gt;
                        &lt;pre&gt;pre-formatted fixed-width code block&lt;/pre&gt;
                        &lt;pre&gt;&lt;code class="language-python"&gt;pre-formatted fixed-width code block written in the Python programming language&lt;/code&gt;&lt;/pre&gt;</code></pre>

                                    </div>


                                </div>
                                <div class="col-md-4">
                                    <ul class="list-group">
                                        <li class="list-group-item list-group-item-success">اللهم لا علم لنا إلا ما علمتنا ، إنك أنت العليم الحكيم، اللهم علمنا ما ينفعنا ، وانفعنا بما علمتنا ، وزدنا علما</li>
                                        <li class="list-group-item text-right">
                                            <span class="text-right">BasheirHassan</span>
                                            <a href="https://twitter.com/basheirhassan?lang=en" target="_blank" class="twitter"><i class="fa fa-twitter fa-3x"></i></a>

                                        </li>
                                        <li class="list-group-item text-right">
                                            <span class="text-right">BasheirHassan</span>
                                            <a href="https://www.youtube.com/watch?v=-imlCMmdO-k&feature=emb_title" target="_blank" class="youtube"><i class="fa fa-youtube fa-3x"></i></a>
                                        </li>

                                        <li class="list-group-item text-right">
                                            <span class="text-right">BasheirHassan</span>
                                            <a href="https://github.com/BasheirHassan?tab=repositories" target="_blank" class="youtube"><i class="fa fa-github fa-3x"></i></a>
                                        </li>
                                    </ul>


                                </div>
                                <div class="col-md-12">

                                    <iframe width="600" height="400" src="https://www.youtube.com/embed/SCpZUmIJ0Dw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

                                </div>
                            </div>

                        </div>

                    </div>





                    <div class="row">
                        <label class="col-sm-2 control-label"
                               for="module_notificationTelegram_status">{{ entry_status }}</label>

                        <div class="col-sm-10">
                            <select name="module_notificationTelegram_status"
                                    id="module_notificationTelegram_status"
                                    class="form-control">
                                {% if module_notificationTelegram_status %}
                                    <option value="1" selected>{{ text_enabled }}</option>
                                    <option value="0">{{ text_disabled }}</option>
                                {% else %}
                                    <option value="1">{{ text_enabled }}</option>
                                    <option value="0" selected>{{ text_disabled }}</option>
                                {% endif %}
                            </select>
                        </div>
                    </div>

                </div>
            </div>
        </div>


    </form>


    <script type="text/javascript">


        var newOrderObj = ["order_id", "store_name", "customer_id", "firstname", "lastname", "email", "telephone", "payment_firstname", "payment_lastname", "payment_address_1", "payment_address_2", "payment_city", "payment_zone", "payment_country", "payment_address_format", "payment_method", "shipping_firstname", "shipping_lastname", "shipping_company", "shipping_address_1", "shipping_address_2", "shipping_postcode", "shipping_city", "shipping_zone", "shipping_country", "shipping_address_format", "shipping_method", "comment", "total", "order_status_id", "order_status", "currency_value", "date_added", "date_modified"];
        var objNewCustemer = ["firstname", "lastname", "email", "telephone"];
        var objProduct = ["order_product_id", "order_id", "product_id", "name", "model", "quantity", "price", "total", "tax", "reward", "product_url"];


        $(document).ready(function () {



            $.each(newOrderObj, function (key, value) {

               $("#newOrderList").append('<label class="btn btn-secondary"><button type="button" class="btn btn-default newOrderButton p-3 ">'+value+'</button></label>');
            });


            $.each(objNewCustemer, function (key, value) {

                $("#buttonKeyNewCustemer").append('<label class="btn btn-secondary"><button type="button" class="btn btn-default NewCustemerButton t-1">'+value+'</button></label>');

            });

            $.each(objProduct, function (key, value) {

                $("#buttonKeyProduct").append('<label class="btn btn-secondary"><button type="button" class="btn btn-default productButton t-1">'+value+'</button></label>');

            });

        });



        $(document).on('click','.newOrderButton',function () {
            var that = $(this).text();
            var newOrderTextArea = $("#module_notificationTelegram_new_order_meassage");
            newOrderTextArea.val(newOrderTextArea.val() + formatVar(that));

        });


         $(document).on('click','.NewCustemerButton',function () {
            var that = $(this).text();
            var newCustemerTextArea = $("#module_notificationTelegram_new_custemer_meassage");
            newCustemerTextArea.val(newCustemerTextArea.val() + formatVar(that))

        });


         $(document).on('click','.productButton',function () {
            var that = $(this).text();
            var productTextArea = $("#module_notificationTelegram_product_meassage");
            productTextArea.val(productTextArea.val() + formatVar(that))

        });



         function formatVar(t) {

            return " {"+t+"} ";
         }





        function appChatID() {
            var html = '<div style=" padding-top: 3px;"  class="input-group col-md-6 parent"><span class="input-group-addon" id="basic-addon1">{{ entry_chatID }} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><input type="text" name="module_notificationTelegram_chat_ids[]" class="form-control"  value="{{ val }}"/><span class="input-group-btn"><button   class="btn btn-danger removed" type="button"><i class="fa fa-trash-o"></i></button></span> </div>';
            $('#groubChatID').append(html);
        }





        $(document).on('click','.removed',function () {
            $(this).parent().prevAll('input').remove();
            $(this).parent().prevAll('div').remove();
            $(this).parent().prevAll('span').remove();
            $(this).remove();
        });




        $(document).ready(function () {

            $('#test').click(function (e) {

                $('.input-group-addon').button('loading');

                $('input[name^="module_notificationTelegram_chat_ids"]').each(function () {

                    var obj = $(this);
                    var val = obj.val();


                    var testurl = '{{ testUrl }}&module_notificationTelegram_boot_token=' + $('#module_notificationTelegram_boot_token').val() + '&module_notificationTelegram_chat_ids=' + val;

                    $.get(testurl, function (e) {
                       $('.input-group-addon').button('reset');

                        if (e.ok == 1) {
                            obj.attr('style', "border-radius: 5px; border:#8fbb6c 1px solid;");

                            $("#status").append('<div class="alert alert-success">{{ text_sent_success }} : ' + val + '</div>');
                        } else {
                            obj.attr('style', "border-radius: 5px; border:#FF0000 1px solid;");
                            obj.append('<div class="alert alert-danger">Message couldnt be sent, please check your details ---' + val + '</div>');
                        }
                    }, "json");
                });


            });
        });


    </script>


    {{ footer }}


